{% extends 'base.html' %}

{% block content %}
<h2 class="mb-3">Settings</h2>

<form method="post" action="{% url 'profile_edit' %}" enctype="multipart/form-data" novalidate>
  {% csrf_token %}

  {% if form.non_field_errors %}
    <div class="alert alert-danger">
      {% for e in form.non_field_errors %}{{ e }}{% endfor %}
    </div>
  {% endif %}

  <div class="mb-3">
    <label class="form-label" for="{{ form.username.id_for_label }}">Nick</label>
    {{ form.username }}
    {% if form.username.errors %}
      <div class="text-danger small mt-1">
        {% for e in form.username.errors %}{{ e }}{% endfor %}
      </div>
    {% endif %}
  </div>

  <div class="mb-3">
    <label class="form-label" for="{{ form.email.id_for_label }}">Email</label>
    {{ form.email }}
    {% if form.email.errors %}
      <div class="text-danger small mt-1">
        {% for e in form.email.errors %}{{ e }}{% endfor %}
      </div>
    {% endif %}
  </div>

  <div class="mb-3">
    <label class="form-label" for="{{ form.avatar.id_for_label }}">Upload avatar</label>
    {{ form.avatar }}
    {% if user.profile.avatar %}
      <div class="mt-2">
        <img src="{{ user.profile.avatar.url }}" alt="avatar" class="rounded border" style="width:96px;height:96px;object-fit:cover;">
      </div>
    {% endif %}
    {% if form.avatar.errors %}
      <div class="text-danger small mt-1">
        {% for e in form.avatar.errors %}{{ e }}{% endfor %}
      </div>
    {% endif %}
  </div>

  <button class="btn btn-primary" type="submit">Save</button>
</form>
{% endblock %}
